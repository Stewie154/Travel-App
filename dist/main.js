(()=>{"use strict";const t="898dd45145c1421d9c7b8c5a06c06f42";let e;let a;let n,o,c,i,l,r,s,d,g,p,h,y,m=new Date;document.getElementById("generate").addEventListener("click",(function(){w()}));const u=async()=>{i=document.getElementById("city").value,l=new Date(document.getElementById("year").value,document.getElementById("month").value,document.getElementById("day").value);let t=document.getElementById("year").value;r=((t,e)=>t.toString().split("").slice(0,10).join("")+"  "+e)(l,t),d=`http://api.geonames.org/searchJSON?q=${i}&maxRows=10&username=stewart_mcfarlane`;try{await f(d).then((function(t){n=t.geonames[0].lat,o=t.geonames[0].lng,c=t.geonames[0].countryName,s=((t,e)=>{const a=(e.getTime()-t.getTime())/864e5;return Math.ceil(a)})(m,l),console.log("1. ",n,o,c,s)}))}catch(t){console.log("Error! (geoNamesApiCall)",t)}},w=async()=>{try{await u(),await(async()=>{if(s<=7){e=`http://api.weatherbit.io/v2.0/current?lat=${n}&lon=${o}&key=${t}`;try{await f(e).then((function(t){g=t.data[0].temp,h=t.data[0].city_name,console.log("2. ",g,h)}))}catch(t){console.log("Error! (weatherBitApiCall)",t)}}else{e=`http://api.weatherbit.io/v2.0/forecast/daily?lat=${n}&lon=${o}&key=${t}`;try{await f(e).then((function(t){g=t.data[15].temp,h=t.city_name,console.log("2. ",g,h)}))}catch(t){console.log("Error! (weatherBitApiCall)",t)}}})(),await(async()=>{y=i.replace(/\s/g,"+"),a=`https://pixabay.com/api/?key=20587250-ac9af3276366082f33b68d905&q=${y}&image_type=photo`;try{await f(a).then((function(t){p=t.hits[0].largeImageURL,console.log("3. ",p)}))}catch(t){console.log("Error! (pixabayApiCall)",t)}})(),await E("http://localhost:2000/addData",{country:c,city:h,temperature:g,tripDate:r,daysToTrip:s,imgUrl:p}).then(await v())}catch(t){console.log("Error! (handleSubmit)",t)}},f=async t=>{const e=await fetch(t);try{const t=await e.json();return console.log(t),t}catch(t){console.log("Error!",t)}},E=async(t="",e)=>{const a=await fetch(t,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});try{const t=await a.json();return console.log(t),t}catch(t){console.log("Error!",t)}},v=async()=>{const t=await fetch("http://localhost:2000/all");try{const e=await t.json();let a=e[e.length-1].country;const n=`\n        <div class="trip">\n            <div class="left-side">\n                <h4 class="destination">Your destination is: ${e[e.length-1].city}, ${a}</h4>\n                <p>The closet weather forecast reads: <span id="temperature"> ${e[e.length-1].temperature} </span>degrees</p>\n                <p>You're leaving on: <span id="display-date">${e[e.length-1].tripDate}</span></p>\n                <p>Your trip is in <span id="countdown">${e[e.length-1].daysToTrip}</span> days!</p>\n            </div>\n            <div class="right-side">\n                <img src="${e[e.length-1].imgUrl}" alt="">\n            </div>\n        </div>\n        `;document.getElementById("trips-container").insertAdjacentHTML("afterbegin",n),console.log("UI Updated")}catch(t){console.log("Error! (updateUI)",t)}}})();